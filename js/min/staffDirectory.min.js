function staffDirectorySearch(){$("#load").show();$(".addresses,.feedback").fadeOut();$(".addresses").html("");theQuery=new Query($("#lastName").val(),$("#firstName").val(),$("#state").val(),$("#zip").val(),$("#contactGroup").val());console.log(theQuery.request());giveFeedback(theQuery.feedback());search(theQuery.request());$("html, body").animate({scrollTop:$("#results").offset().top},500)}function Query(e,t,n,r,i){var s="length",o="lastNameR",u="lastName",a="firstNameR",f="firstName",l="none",c="stateR",h=" ";if(e[s]>0){this[o]="/ln/"+e;this[u]=e}else this[o]="",this[u]="";if(t[s]>0){this[a]="/fn/"+t;this[f]=t}else this[a]="",this[f]="";if(n!==l){this[c]="/st/"+n;this.state=n}else this[c]="",this.state="";if(r[s]>0){this.zipR="/zip/"+r;this.zip=r}else this.zipR="",this.zip="";this.request=function(){return i===l?baseURL+this[a]+this[o]+this[c]+this.zipR:groupURL+"/"+i};this.isGroup=function(){return i===l?!1:!0};this.feedback=function(){return i===l?this[u]+h+this[f]+h+this.state+h+this.zip:i.split("%20").join(h)}}function search(e){var t="gsaContactGroup",n="NO RESULTS",r=!1,i="gsaAssociate",s="html",o=".addresses #",u="streetAddress",a=null,f="roomNumber",l="emailAddress",c="href",h="phoneNumber",p="faxNumber",d="tel:1";$.getJSON(e,function(e){console.log(e);if(theQuery.isGroup()===!0){if(e[t][0]===undefined){console.log(n);loaded(r);return}var m=e[t][0][i]}else var m=e[i];if(m.length==0){console.log(n);loaded(r);return}$.each(m,function(e,t){var n="card"+e;$(addressCard).appendTo(".addresses").attr("id",n);$(o+n+" .name .name")[s](t.firstName+" "+t.lastName);$(o+n+" .name .title")[s](t.title);if(t[u]!=a){t[f]!=a?roomNumber="<br>Room: "+t[f]:roomNumber="";$(o+n+" .address .address")[s](t[u]+"<br>"+t.city+", "+t.state+", "+t.zip+roomNumber)}t[l]!=a&&$(o+n+" .address .email a")[s](t[l]).attr(c,"mailto:"+t[l]);if(t[h]!=a||t[p]!=a){$(o+n+" div.tel").remove();$(telEntry).insertAfter(o+n+" div.address");if(t[h]!=a){$(o+n+" span.tel strong")[s]("Tel: ");$(o+n+" span.tel a")[s](formatNumber(t[h])).attr(c,d+t[h])}if(t[p]!=a){$(o+n+" span.fax strong")[s]("Fax: ");$(o+n+" span.fax a")[s](formatNumber(t[p])).attr(c,d+t[p])}}},loaded())}).error(function(){loaded(r)})}function giveFeedback(e){$(".feedback").html('Your Search: "'+e+'"')}function formatNumber(e){var t="substring";return e.indexOf("(")>0||e.indexOf("-")>0?e:"("+e[t](0,3)+") "+e[t](3,6)+"-"+e[t](6,10)}function loaded(e){var t=".addresses",n="#load";e==0?$(t).html("<h4>No Results.</h4>"):$(".addresses h4").remove();$(t).length<=1?$(n).fadeOut():$(n).slideUp();$(".addresses,.feedback").fadeIn();$("#contactGroup").val(0)}$(function(){var e="#feedback-form",t=".addresses,#feedback",n="form input, form select",r="click",i="#searchSwitch button",s="removeClass",o="active",u="addClass",a="#results",f=".display-mode .cards",l="ul.addresses",c="cards",h=".display-mode .list",p=!1;$("#hidden_iframe").load(function(){(p=!0)&&$(e).fadeOut(600,function(){$("#thanks").delay(1e3).fadeIn(600)})});$(e).submit(function(){p=!0});$(t).html("");$(n).val("");$(i)[r](function(){$("#searches > form,#searches > div, #keyContacts").hide();$(i)[s](o);var e=$(this).attr("id");$("#searches ."+e).show();$(this)[u](o);if(e==="staffDirectory")$(a).show();else if(e==="byTopic"){$(a).show();$("#keyContacts").show()}else $(a).hide();$(t).html("");$(n).val("")});$("#search,#groupSearch")[r](function(){staffDirectorySearch();return!1});$(f)[r](function(){$(l)[u](c);$(f)[u](o);$(h)[s](o)});$(h)[r](function(){$(l)[s](c);$(h)[u](o);$(f)[s](o)});if(window.location.href.indexOf("?feedback")>0){$("button#feedbackForm")[r]();console.log("?FEEDBACK")}});var baseURL=root+"/api/rs/a",groupURL=root+"/api/rs/group",addressCard='<li><div class="top"><a href="#"><img alt="GSA" src="http://www.gsa.gov/graphics/staffoffices/GSAStarMarkweblogopolicy3333.jpg"></a><div class="name"><span class="name"></span><span class="title"></span></div></div><div class="bottom"><div class="address"><span class="address"></span><span class="email"><a href="mailto:"></a></span></div></div></li>',telEntry='<div class="tel"><span class="tel"><strong></strong><a href=""></a></span><span class="fax"><strong></strong><a href="tel+1"></a></span></div>';