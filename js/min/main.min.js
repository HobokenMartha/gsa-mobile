function bindings(){routie({"":Router.homePage,"!":Router.homePage,"/*":Router.addBang,"!/content/*":Router.addPortal,"!/portal/*":Router.fullSiteAJAX,"!/travel/smartpay*":Router.smartPayAJAX,"!/*":Router.mobileSiteHTML}),$("header button#menu").click(function(){return $("#slider").toggle().toggleClass("active"),$(this).toggleClass("active"),!1}),$("#slider a").click(function(){$("#slider").toggle().toggleClass("active"),$("header button#menu").toggleClass("active")}),$("#container").on("click",".accordion-item-title",function(){return $(this).next("div").toggle(),$(this).find("i").toggleClass("icon-chevron-down").toggleClass("icon-chevron-up"),!1}).on("click",".alert span",function(){$(this).parent().remove()}),$(".backToTop button").click(scrollToTop),$("#container").on("click",".additionalTerms",function(){return $("#additionalTerms").toggle(),!1}),$("header #submitIcon").click(function(){$("#search_form").submit()}),$("#fullSite").click(function(){$.cookie("gsaMobileForward","www",{expires:3650,path:"/",domain:".gsa.gov"}),window.location.href=wwwRoot})}function backToTop(){var a=$(window).height(),b=$("#container").height();b>1.5*a?$(".backToTop").show():$(".backToTop").hide()}function preLoad(){loadTimeout=setTimeout(function(){$("footer,.footer").hide(),$("#container").html(""),$("#load").show()},500)}function postLoad(){clearTimeout(loadTimeout),$("footer,.footer").show(),$("#load").hide(),$("#slider").hide().removeClass("active"),$("#menu").removeClass("active"),setTitle(),inPageAjax()}function loadError(a){if($("#container").html(""),!a)var a="We're Sorry. The content you've requested can not be loaded at this time.";var b='<div class="alert alert-error" style="margin-bottom:20px;">'+a+"</div>";$("#container").prepend(b)}function inPageAjax(){$("#container .ajax")&&(console.log("found one"),$("#container .ajax").each(function(){var a=$(this).attr("data-url")+" "+$(this).attr("data-selector");console.log(a),console.log($(this)),$(this).load(a,function(){cleanContent($(this)),$(this).removeClass("load")})}))}function initUserStats(){if($.cookie("gsaMobileUserStats"))userStats=JSON.parse($.cookie("gsaMobileUserStats"));else{if("never"===$.cookie("gsaMobileSurvey")||"completed"===$.cookie("gsaMobileSurvey"))var a=$.cookie("gsaMobileSurvey");else var a=null;$.removeCookie("gsaMobileSurvey",{path:"/",domain:".gsa.gov"}),userStats={pageViews:0,externalLinks:0,survey:{status:a,counter:0},userAgent:navigator.userAgent}}if(void 0!==userStats.surveyStatus){var b=userStats.surveyStatus;userStats.survey={status:b,counter:0},delete userStats.surveyStatus}userStats.pageViews=userStats.pageViews+1,$.cookie("gsaMobileUserStats",JSON.stringify(userStats),{expires:3650,path:"/",domain:".gsa.gov"})}function scrollToTop(){$("html, body").animate({scrollTop:$("body").offset().top},1)}function setTitle(a){if(void 0===a){var b=$("#container h1:first-child").text();document.title=b.length>0?b+" - GSA Mobile":"GSA Mobile"}else document.title=a}function clearNav(){$("#tabs a").removeClass("active")}function highlightNav(a){console.log(a),$("#tabs a").removeClass("active"),a.indexOf("travel")>-1&&$("#tabs a.travel").addClass("active"),a.indexOf("buildings")>-1&&$("#tabs a.buildings").addClass("active"),a.indexOf("buy-sell")>-1&&$("#tabs a.buy-sell").addClass("active"),a.indexOf("regulations")>-1&&$("#tabs a.regulations").addClass("active"),a.indexOf("about-gsa")>-1&&$("#tabs a.about-gsa").addClass("active")}function cleanContent(a){if(!a)var a=$("#container");a.find("*[style]").removeAttr("style"),a.find("img").removeAttr("align"),a.find("script,#container span.stylesheet").remove(),a.find("table").addClass("table"),a.find(".Subtitle").each(function(){var a=$(this).html();$(this).replaceWith("<h3>"+a+"</h3>")}),a.find("> div").addClass("ajaxed"),a.find('a[href*="#"]').remove(),a.find("li span:empty").parents("ul").remove(),a.find("li:empty").remove(),a.find("a").attr("target","_blank"),a.find("table").attr("border","0"),a.find("h1,h2,h3,h4,h5,h6").filter(function(){return""===$.trim($(this).text())&&0===$(this).children().length}).remove(),a.find(".SectionTitle").each(function(){var a=$(this).html();$(this).replaceWith("<h4>"+a+"</h4>")}),responsiveTables(a)}function responsiveTables(a){a.find("table").each(function(){$(this).addClass("table-responsive");var a=$(this);$(this).find("td").each(function(){var c=$(this).parent().children().index($(this)),d=a.find("th").eq(c).text();$(this).attr("data-header",d)})})}function cleanSmartPayContent(){var a=$("table td:first-child").html();$("table").remove(),$("h2").after('<div class="smartPayContent">'+a+"</div>")}function cleanLinks(a,b){$("#container "+a).each(function(){if($(this).attr(b)){var a=$(this).attr(b);if(a.indexOf(":")>-1)return!1;$(this).attr(b,"http://gsa.gov"+a)}})}function isNumber(a){return!isNaN(parseFloat(a))&&isFinite(a)}function emergencyBanner(){$("#banner-ER-stage").load("http://dev.m.gsa.gov/portal/content/117474 .banner-feed-wrap",function(){var a=$(".banner-ER-status .disGoes").text().toLowerCase();if("active"===a){var b=$(".banner-ER-title .disGoes").text().toUpperCase(),c=$(".banner-ER-theme-color .disGoes").text().toLowerCase(),d=$(".banner-ER-message .disGoes").text(),e=$(".banner-ER-link .disGoes").text();"red"===c&&$("header").append('<div class="container"><div id="banner-ER-live" class="alert alert-danger"></div></div>'),"yellow"===c&&$("header").append('<div class="container"><div id="banner-ER-live" class="alert alert-warning"></div></div>'),"green"===c&&$("header").append('<div class="container"><div id="banner-ER-live" class="alert alert-success"></div></div>'),$("#banner-ER-live").append("<h4>"+b+"</h4><br><p>"+d+'</p><a class="surveyExempt" href="http://gsa.gov'+e+'">READ MORE&gt;&gt;</a>')}})}function analyticsMeta(){if("http://m.gsa.gov"===root){var a=$('#container meta[name="title"]').attr("content"),b=$('#container meta[name="organization"]').attr("content"),c=$('#container meta[name="program"]').attr("content");"undefined"!=typeof _gaq&&(""!=a&&_gaq.push(["_setCustomVar",1,"title",a,3]),""!=b&&_gaq.push(["_setCustomVar",2,"organization",b,3]),""!=c&&_gaq.push(["_setCustomVar",3,"program",c,3]),_gaq.push(["_trackPageview","/"+window.location.hash]))}}var root=window.location.protocol+"//"+window.location.hostname,mRoot=window.location.protocol+"//"+window.location.hostname+"/m",wwwRoot=window.location.protocol+"//"+window.location.hostname+"/portal",homePage="",userStats={},loadTimeout;-1===window.location.href.indexOf("?_escaped_fragment_")&&$(function(){homePage=$("#home").html(),bindings(),$(window).resize(function(){backToTop()}),emergencyBanner(),initUserStats()});var Router={homePage:function(){preLoad(),$("#container").html(homePage),setTitle("GSA Mobile"),$("#homepageRFB").rfb(),clearNav(),postLoad()},mobileSiteHTML:function(a){preLoad(),$("#container").load(mRoot+"/"+a,function(b,c){"error"===c&&loadError(),highlightNav(a),analyticsMeta(),postLoad(a)})},fullSiteAJAX:function(a){preLoad(),$("#container").load(wwwRoot+"/"+a+" #content",function(b,c){"error"!==c?(cleanContent(),cleanLinks("img","src"),cleanLinks("a","href")):loadError('Failed to load data from the Full Site at <a href="http://gsa.gov">www.gsa.gov</a>.</div>'),clearNav(),postLoad(a)})},smartPayAJAX:function(a){preLoad(),""===a||"/"===a?$("#container").load(mRoot+"/travel/smartpay",function(b,c){"error"===c&&loadError(),highlightNav(a),analyticsMeta(),postLoad(a)}):$("#container").load("http://smartpay.gsa.gov/"+a+"?mobile=1"+" #docBody",function(b,c){"error"!==c?cleanSmartPayContent():loadError("We're sorry. The SmartPay server could not be reached. Please try again later."),highlightNav(a),postLoad(a)})},removeBang:function(a){window.location.hash="#"+a},addBang:function(a){window.location.hash="#!/"+a},addPortal:function(a){var b=window.location.hash;b.indexOf("content")>-1?window.location.hash="#/portal/content/"+a:b.indexOf("category")>-1&&(window.location.hash="#/portal/category/"+a)}};!function(a){jQuery.fn.rfb=function(b){var c={rfbchunk:"192869"};return b&&a.extend(c,b),this.each(function(){a(this).addClass("rfb well").load(wwwRoot+"/rfbchunk/"+c.rfbchunk,function(b,c){if("error"!==c){a("#screenreader").remove(),a("#rfb").addClass("swipe rfb"),a("#rfb ul").addClass("swipe-wrap"),a("#rfb .navigation,#rfb .contentBG,#rfb p").remove(),a("#rfb h2,.slides").unwrap(),a("#rfb h2").each(function(){var b=a(this).prev(),c=a(this).children("a").text();b.append("<h5>"+c+"</h5>"),a(this).remove()}),a("#rfb .slides li").removeAttr("style").removeClass("slide"),a("#rfb .slides").removeClass("slides"),a("#rfb a").attr("target","_blank"),window.rfb=new Swipe(document.getElementById("rfb"),{auto:7e3,callback:function(b){a("#rfb nav li.on").removeClass("on"),a("#rfb nav li:eq("+b+")").addClass("on")}});var d='<nav><ul id="position"></ul></nav>',e=window.rfb.getNumSlides();a("#rfb").append(d);for(var f=1;e>=f;f++)a("#rfb nav ul").append("<li></li>");a("#rfb nav ul li:first-child").addClass("on"),a("#rfb nav ul li").click(function(){var b=a(this).index();window.rfb.slide(b,400)})}})})}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function c(a){return a}function d(a){return decodeURIComponent(a.replace(b," "))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(b){}}var b=/\+/g,f=a.cookie=function(b,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):String(g),document.cookie=[f.raw?b:encodeURIComponent(b),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?c:d,l=document.cookie.split("; "),m=b?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(b&&b===q){m=e(r);break}b||(m[q]=e(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend({},c,{expires:-1})),!0):!1}}),function(a,b,c){function j(a){return a=a||location.href,"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var f,d="hashchange",e=document,g=a.event.special,h=e.documentMode,i="on"+d in b&&(h===c||h>7);a.fn[d]=function(a){return a?this.bind(d,a):this.trigger(d)},a.fn[d].delay=50,g[d]=a.extend(g[d],{setup:function(){return i?!1:(a(f.start),void 0)},teardown:function(){return i?!1:(a(f.stop),void 0)}}),f=function(){function n(){var c=j(),e=m(h);c!==h?(l(h=c,e),a(b).trigger(d)):e!==h&&(location.href=location.href.replace(/#.*/,"")+e),g=setTimeout(n,a.fn[d].delay)}var g,f={},h=j(),k=function(a){return a},l=k,m=k;return f.start=function(){g||n()},f.stop=function(){g&&clearTimeout(g),g=c},a.browser.msie&&!i&&function(){var b,c;f.start=function(){b||(c=a.fn[d].src,c=c&&c+j(),b=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){c||l(j()),n()}).attr("src",c||"javascript:0").insertAfter("body")[0].contentWindow,e.onpropertychange=function(){try{"title"===event.propertyName&&(b.document.title=e.title)}catch(a){}})},f.stop=k,m=function(){return j(b.location.href)},l=function(c,f){var g=b.document,h=a.fn[d].domain;c!==f&&(g.title=e.title,g.open(),h&&g.write('<script>document.domain="'+h+'"</script>'),g.close(),b.location.hash=c)}}(),f}()}(jQuery,this),function(a){a.fn.FeedEk=function(b){var e,c=a.extend({FeedUrl:"http://rss.cnn.com/rss/edition.rss",MaxCount:5,ShowDesc:!0,ShowPubDate:!0,CharacterLimit:0,TitleLinkTarget:"_blank"},b),d=a(this).attr("id");a("#"+d).empty().append('<img src="img/load.gif" />'),a.ajax({url:"http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num="+c.MaxCount+"&output=json&q="+encodeURIComponent(c.FeedUrl)+"&hl=en&callback=?",dataType:"json",success:function(b){a("#"+d).empty();var f="";a.each(b.responseData.feed.entries,function(a,b){f+='<a class="accordion-item-title">'+b.title+'<i class="icon-chevron-down"></i></a>',c.ShowPubDate&&(e=new Date(b.publishedDate),f+='<div class="itemDate">'+e.toLocaleDateString()+"</div>"),c.ShowDesc&&(f+=c.DescCharacterLimit>0&&b.content.length>c.DescCharacterLimit?'<div class="itemContent">'+b.content.substr(0,c.DescCharacterLimit)+"...</div>":"<div>"+b.content+'<br><br><a href="'+b.link+'" target="'+c.TitleLinkTarget+'" ><span class="btn">More Detail</span></a><br></div>')}),a("#"+d).append('<div class="simple-accordion">'+f+"</div>",function(){a("font[color=#007fc2]").replaceWith("font[color=#333]")})}})}}(jQuery);